(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{449:function(s,t,a){"use strict";a.r(t);var e=a(2),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("a",{attrs:{href:"https://post.smzdm.com/p/az3g5zpr/",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考连接"),t("OutboundLink")],1),s._v(" "),t("a",{attrs:{href:"https://post.smzdm.com/p/az370qk5/",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考连接"),t("OutboundLink")],1)]),s._v(" "),t("h1",{attrs:{id:"home-assistant-外网访问指北-群晖反向代理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#home-assistant-外网访问指北-群晖反向代理"}},[s._v("#")]),s._v(" Home Assistant 外网访问指北（群晖反向代理）")]),s._v(" "),t("h2",{attrs:{id:"安装homeassistant"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装homeassistant"}},[s._v("#")]),s._v(" 安装homeassistant")]),s._v(" "),t("ol",[t("li",[s._v("在群晖docker-注册表中搜索homeassistant双击安装")]),s._v(" "),t("li",[s._v("在本地目录新建homeassistant目录，用于存放配置文件")]),s._v(" "),t("li",[s._v("注册表中双击刚刚下载的映像，新建容器\n"),t("ol",[t("li",[s._v("选择高级设置 选择储存空间 挂载刚刚创建的目录 为"),t("code",[s._v("/config")])]),s._v(" "),t("li",[s._v("网络选择端口设置，容器端口设置为8123，本地端口也可以设置为8123")]),s._v(" "),t("li",[s._v("环境变量新增 key:"),t("code",[s._v("TZ")]),s._v(",value:"),t("code",[s._v("Asia/Shanghai")]),s._v("，设置docker时区为中国")]),s._v(" "),t("li",[s._v("如果需要群晖重启后自动开启，需要勾选"),t("code",[s._v("启用自动重新启动")])])])]),s._v(" "),t("li",[s._v("点击完成启动容器")])]),s._v(" "),t("h2",{attrs:{id:"外网访问"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#外网访问"}},[s._v("#")]),s._v(" 外网访问")]),s._v(" "),t("ol",[t("li",[s._v("将刚刚设置的本地端口进行转发即可")])]),s._v(" "),t("h2",{attrs:{id:"外网升级https"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#外网升级https"}},[s._v("#")]),s._v(" 外网升级https")]),s._v(" "),t("p",[s._v("如果直接使用群晖反向代理外网访问会爆出400，无法访问")]),s._v(" "),t("p",[s._v("网上找了一圈资料，都是很老旧的信息了，还有HASS安装NGINX Home Assistant SSL proxy插件的，可是这个插件早就下架了。以前安装证书的方法也不起作用了，现在都是用反向代理里的证书。后来结合各种教程，发现了解决办法。就是编辑configuration.yaml，添加字段如下。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br")]),t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("  http:\n  use_x_forwarded_for: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  trusted_proxies:\n    - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.16")]),s._v(".100.0/24\n    - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".5.0/24\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("特别注意高亮里的编码，调整为你的局域网网段，我的是5。修改后保存，并重启容器，也就是重启下Home Assistant 。")]),s._v(" "),t("p",[s._v("然后去控制面板-应用程序门户-反向代理服务器。\n新增一个Home Assistant 的反向代理\n但是，事实告诉我们，不要高兴的太早。在你填入用户名和密码后，会弹出这个界面，根本无法登录。惊不惊喜？意不意外？这是因为Home Assistant的登录需要websocke支持。所以继续看下去吧。\n再去反向代理页面，编辑刚才建立的Home Assistant反向代理，在自定义标头那点击新增一个websocke标题，直接点击这个就可以了，底下会自动出来两个标头，不用修改，直接确定就可以了。")])])}),[],!1,null,null,null);t.default=r.exports}}]);