<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>spread.js常用api | zvue</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.0ab6a768.css" as="style"><link rel="preload" href="/assets/js/app.79fcf93e.js" as="script"><link rel="preload" href="/assets/js/3.9446284f.js" as="script"><link rel="preload" href="/assets/js/1.83d3f97c.js" as="script"><link rel="preload" href="/assets/js/37.8ab9d0a9.js" as="script"><link rel="prefetch" href="/assets/js/10.701200e3.js"><link rel="prefetch" href="/assets/js/11.275f16fd.js"><link rel="prefetch" href="/assets/js/12.f8ab336d.js"><link rel="prefetch" href="/assets/js/13.5841f8be.js"><link rel="prefetch" href="/assets/js/14.18de3850.js"><link rel="prefetch" href="/assets/js/15.e3193774.js"><link rel="prefetch" href="/assets/js/16.c89f0b8f.js"><link rel="prefetch" href="/assets/js/17.dc3bb0c0.js"><link rel="prefetch" href="/assets/js/18.e3a0b77d.js"><link rel="prefetch" href="/assets/js/19.c615258e.js"><link rel="prefetch" href="/assets/js/20.f999ee22.js"><link rel="prefetch" href="/assets/js/21.46852247.js"><link rel="prefetch" href="/assets/js/22.a1e96022.js"><link rel="prefetch" href="/assets/js/23.94788724.js"><link rel="prefetch" href="/assets/js/24.fb37a205.js"><link rel="prefetch" href="/assets/js/25.bac60109.js"><link rel="prefetch" href="/assets/js/26.851d8f0c.js"><link rel="prefetch" href="/assets/js/27.f407c03d.js"><link rel="prefetch" href="/assets/js/28.4dee56f4.js"><link rel="prefetch" href="/assets/js/29.1568f46d.js"><link rel="prefetch" href="/assets/js/30.178a4140.js"><link rel="prefetch" href="/assets/js/31.d6eac92e.js"><link rel="prefetch" href="/assets/js/32.682a6909.js"><link rel="prefetch" href="/assets/js/33.a2229843.js"><link rel="prefetch" href="/assets/js/34.e6e106d7.js"><link rel="prefetch" href="/assets/js/35.23bdd722.js"><link rel="prefetch" href="/assets/js/36.516ce882.js"><link rel="prefetch" href="/assets/js/38.1ab2b4aa.js"><link rel="prefetch" href="/assets/js/39.b628cb26.js"><link rel="prefetch" href="/assets/js/4.a126a949.js"><link rel="prefetch" href="/assets/js/40.721053f2.js"><link rel="prefetch" href="/assets/js/41.c93c29bb.js"><link rel="prefetch" href="/assets/js/42.b9486543.js"><link rel="prefetch" href="/assets/js/43.6535ff61.js"><link rel="prefetch" href="/assets/js/44.42cc53ce.js"><link rel="prefetch" href="/assets/js/45.ab9f0218.js"><link rel="prefetch" href="/assets/js/46.ca191973.js"><link rel="prefetch" href="/assets/js/47.953a858f.js"><link rel="prefetch" href="/assets/js/48.48101037.js"><link rel="prefetch" href="/assets/js/49.ebe44af2.js"><link rel="prefetch" href="/assets/js/5.2f9f316b.js"><link rel="prefetch" href="/assets/js/50.fe92fcb8.js"><link rel="prefetch" href="/assets/js/51.74907353.js"><link rel="prefetch" href="/assets/js/52.0d58ec3b.js"><link rel="prefetch" href="/assets/js/53.a3f87dbc.js"><link rel="prefetch" href="/assets/js/54.89e1d576.js"><link rel="prefetch" href="/assets/js/55.36bc7987.js"><link rel="prefetch" href="/assets/js/56.663cefbe.js"><link rel="prefetch" href="/assets/js/57.4dbb089e.js"><link rel="prefetch" href="/assets/js/58.4c7954a7.js"><link rel="prefetch" href="/assets/js/59.e337873c.js"><link rel="prefetch" href="/assets/js/6.79caa79a.js"><link rel="prefetch" href="/assets/js/60.62dc1d0a.js"><link rel="prefetch" href="/assets/js/61.fa5d4567.js"><link rel="prefetch" href="/assets/js/62.98ff8ff7.js"><link rel="prefetch" href="/assets/js/63.cc2e73f6.js"><link rel="prefetch" href="/assets/js/64.27fb9823.js"><link rel="prefetch" href="/assets/js/65.153fdc29.js"><link rel="prefetch" href="/assets/js/66.0fbca66c.js"><link rel="prefetch" href="/assets/js/67.510619db.js"><link rel="prefetch" href="/assets/js/68.f1cd1e56.js"><link rel="prefetch" href="/assets/js/69.07313582.js"><link rel="prefetch" href="/assets/js/7.b82c441b.js"><link rel="prefetch" href="/assets/js/70.08bdfc27.js"><link rel="prefetch" href="/assets/js/71.1cf4b650.js"><link rel="prefetch" href="/assets/js/72.6f64729d.js"><link rel="prefetch" href="/assets/js/73.bd823c17.js"><link rel="prefetch" href="/assets/js/74.c9473203.js"><link rel="prefetch" href="/assets/js/75.78373fae.js"><link rel="prefetch" href="/assets/js/76.cf16bb24.js"><link rel="prefetch" href="/assets/js/77.1a22e988.js"><link rel="prefetch" href="/assets/js/78.8754430d.js"><link rel="prefetch" href="/assets/js/79.a39a8ca0.js"><link rel="prefetch" href="/assets/js/8.9cc0f7d8.js"><link rel="prefetch" href="/assets/js/80.99dc5cdc.js"><link rel="prefetch" href="/assets/js/81.63641222.js"><link rel="prefetch" href="/assets/js/82.c964c56c.js"><link rel="prefetch" href="/assets/js/83.30118c3d.js"><link rel="prefetch" href="/assets/js/84.5720dccd.js"><link rel="prefetch" href="/assets/js/85.4f7a7c75.js"><link rel="prefetch" href="/assets/js/86.3a01ad50.js"><link rel="prefetch" href="/assets/js/87.099a6d75.js"><link rel="prefetch" href="/assets/js/9.0d65730a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0ab6a768.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-5bb33761><div data-v-5bb33761><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-5bb33761 data-v-5bb33761><h3 class="title" data-v-59e6cb88>zvue</h3> <p class="description" data-v-59e6cb88></p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>9374</span>
          
        <span data-v-59e6cb88>2018 - </span>
        2023
      </a></span></div></div> <div class="hide" data-v-5bb33761><header class="navbar" data-v-5bb33761><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">zvue</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/chrome/" class="nav-link"><i class="undefined"></i>
  chrome
</a></li><li class="dropdown-item"><!----> <a href="/categories/eslint/" class="nav-link"><i class="undefined"></i>
  eslint
</a></li><li class="dropdown-item"><!----> <a href="/categories/css/" class="nav-link"><i class="undefined"></i>
  css
</a></li><li class="dropdown-item"><!----> <a href="/categories/Git/" class="nav-link"><i class="undefined"></i>
  Git
</a></li><li class="dropdown-item"><!----> <a href="/categories/game/" class="nav-link"><i class="undefined"></i>
  game
</a></li><li class="dropdown-item"><!----> <a href="/categories/js/" class="nav-link"><i class="undefined"></i>
  js
</a></li><li class="dropdown-item"><!----> <a href="/categories/jQuery/" class="nav-link"><i class="undefined"></i>
  jQuery
</a></li><li class="dropdown-item"><!----> <a href="/categories/linux/" class="nav-link"><i class="undefined"></i>
  linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/mac/" class="nav-link"><i class="undefined"></i>
  mac
</a></li><li class="dropdown-item"><!----> <a href="/categories/math/" class="nav-link"><i class="undefined"></i>
  math
</a></li><li class="dropdown-item"><!----> <a href="/categories/mobile/" class="nav-link"><i class="undefined"></i>
  mobile
</a></li><li class="dropdown-item"><!----> <a href="/categories/NAS/" class="nav-link"><i class="undefined"></i>
  NAS
</a></li><li class="dropdown-item"><!----> <a href="/categories/node.js/" class="nav-link"><i class="undefined"></i>
  node.js
</a></li><li class="dropdown-item"><!----> <a href="/categories/router/" class="nav-link"><i class="undefined"></i>
  router
</a></li><li class="dropdown-item"><!----> <a href="/categories/python/" class="nav-link"><i class="undefined"></i>
  python
</a></li><li class="dropdown-item"><!----> <a href="/categories/markDown/" class="nav-link"><i class="undefined"></i>
  markDown
</a></li><li class="dropdown-item"><!----> <a href="/categories/vue/" class="nav-link"><i class="undefined"></i>
  vue
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-5bb33761></div> <aside class="sidebar" data-v-5bb33761><div class="personal-info-wrapper" data-v-1fad0c41 data-v-5bb33761><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    9374
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>75</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>68</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/chrome/" class="nav-link"><i class="undefined"></i>
  chrome
</a></li><li class="dropdown-item"><!----> <a href="/categories/eslint/" class="nav-link"><i class="undefined"></i>
  eslint
</a></li><li class="dropdown-item"><!----> <a href="/categories/css/" class="nav-link"><i class="undefined"></i>
  css
</a></li><li class="dropdown-item"><!----> <a href="/categories/Git/" class="nav-link"><i class="undefined"></i>
  Git
</a></li><li class="dropdown-item"><!----> <a href="/categories/game/" class="nav-link"><i class="undefined"></i>
  game
</a></li><li class="dropdown-item"><!----> <a href="/categories/js/" class="nav-link"><i class="undefined"></i>
  js
</a></li><li class="dropdown-item"><!----> <a href="/categories/jQuery/" class="nav-link"><i class="undefined"></i>
  jQuery
</a></li><li class="dropdown-item"><!----> <a href="/categories/linux/" class="nav-link"><i class="undefined"></i>
  linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/mac/" class="nav-link"><i class="undefined"></i>
  mac
</a></li><li class="dropdown-item"><!----> <a href="/categories/math/" class="nav-link"><i class="undefined"></i>
  math
</a></li><li class="dropdown-item"><!----> <a href="/categories/mobile/" class="nav-link"><i class="undefined"></i>
  mobile
</a></li><li class="dropdown-item"><!----> <a href="/categories/NAS/" class="nav-link"><i class="undefined"></i>
  NAS
</a></li><li class="dropdown-item"><!----> <a href="/categories/node.js/" class="nav-link"><i class="undefined"></i>
  node.js
</a></li><li class="dropdown-item"><!----> <a href="/categories/router/" class="nav-link"><i class="undefined"></i>
  router
</a></li><li class="dropdown-item"><!----> <a href="/categories/python/" class="nav-link"><i class="undefined"></i>
  python
</a></li><li class="dropdown-item"><!----> <a href="/categories/markDown/" class="nav-link"><i class="undefined"></i>
  markDown
</a></li><li class="dropdown-item"><!----> <a href="/categories/vue/" class="nav-link"><i class="undefined"></i>
  vue
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-5bb33761><h3 class="title" data-v-59e6cb88>spread.js常用api</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>9374</span>
          
        <span data-v-59e6cb88>2018 - </span>
        2023
      </a></span></div></div> <div data-v-5bb33761><div data-v-5bb33761><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">spread.js常用api</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>9374</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2022/10/17</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>spread.js</span><span class="tag-item" data-v-8a445198>excel</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//传入dom的id 第二个参数optionos 可以不传</span>
spread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GC<span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//表格设置为中文GC.Spread.Common.CultureManager.culture(&quot;zh-cn&quot;);初始化表格时执行'</span>
<span class="token constant">GC</span><span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Common<span class="token punctuation">.</span>CultureManager<span class="token punctuation">.</span><span class="token function">culture</span><span class="token punctuation">(</span><span class="token string">&quot;zh-cn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>options 可以在初始化时传入 也可以在后续手动更改</p></blockquote> <h2 id="配置部分"><a href="#配置部分" class="header-anchor">#</a> 配置部分</h2> <h3 id="spread部分"><a href="#spread部分" class="header-anchor">#</a> spread部分</h3> <table><thead><tr><th>方法</th> <th>作用</th> <th>示例</th></tr></thead> <tbody><tr><td>clearSheets()</td> <td>清除所有sheet页</td> <td>spread.clearSheets()</td></tr> <tr><td>setSheetCount(1)</td> <td>设置sheet页数</td> <td></td></tr> <tr><td>suspendPaint()</td> <td>大多数时候, 在你改变 Spread 之后, 控件会自动刷新以达到重绘和更新状态的目的。 可是, 如果你一次做出大量的改变, 并且不希望每次改变都去重新绘制 Spread , 那么你可以调用 suspendPaint 暂停重绘</td> <td></td></tr> <tr><td>resumePaint()</td> <td>完成改变之后，你可以调用resumePaint 重新激活Spread重绘，</td> <td></td></tr> <tr><td>repaint()</td> <td>如果你的代码逻辑对控件进行修改，但控件未进行自刷新，那么你可以调用repaint方法强制刷新。</td> <td>spread.repaint();</td></tr></tbody></table> <hr> <h2 id="获取sheet对象"><a href="#获取sheet对象" class="header-anchor">#</a> 获取sheet对象</h2> <div class="custom-block tip"><p class="title"></p><p>数据渲染基于每个表格内的每个单元格进行,单元格基于sheet页获取,操作前需要获取sheet对象;</p></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> sheet <span class="token operator">=</span> spread<span class="token punctuation">.</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><hr> <blockquote><p>options 可以在初始化时传入 也可以在后续手动更改</p></blockquote> <h3 id="sheet-options参数"><a href="#sheet-options参数" class="header-anchor">#</a> sheet.options参数</h3> <table><thead><tr><th>属性</th> <th>作用</th> <th>参数</th> <th>示例</th></tr></thead> <tbody><tr><td>allowContextMenu</td> <td>禁用右键</td> <td>boolean</td> <td>sheet.allowContextMenu=false</td></tr> <tr><td>newTabVisible</td> <td>隐藏新建tab按钮</td> <td>boolean</td> <td></td></tr> <tr><td>tabEditable</td> <td>修改sheet名称</td> <td>boolean</td> <td></td></tr> <tr><td>allowSheetReorder</td> <td>禁止sheet移动</td> <td>boolean</td> <td></td></tr> <tr><td>scrollbarMaxAlign</td> <td>鼠标滚轮禁用</td> <td>boolean</td> <td></td></tr> <tr><td>showVerticalScrollbar</td> <td>显示竖向滚动条</td> <td>boolean</td> <td></td></tr> <tr><td>showHorizontalScrollbar</td> <td>显示横向滚动条</td> <td>boolean</td> <td></td></tr> <tr><td>showScrollTip</td> <td>以何种方式显示滚动提示条</td> <td>['both','horizontal','vertical','none']</td> <td>GC.Spread.Sheets.ShowScrollTip.<code>both</code></td></tr></tbody></table> <h3 id="options-gridline"><a href="#options-gridline" class="header-anchor">#</a> options.gridline</h3> <table><thead><tr><th>属性</th> <th>作用</th> <th>参数</th> <th>示例</th></tr></thead> <tbody><tr><td>showHorizontalGridline</td> <td>显示单元格变框线</td> <td>boolean</td> <td>sheet.options.gridline.showHorizontalGridline= false</td></tr> <tr><td>showVerticalGridline</td> <td>显示单元格变框线</td> <td>boolean</td> <td></td></tr></tbody></table> <h3 id="sheet-defaults参数"><a href="#sheet-defaults参数" class="header-anchor">#</a> sheet.defaults参数</h3> <table><thead><tr><th>属性</th> <th>作用</th> <th>参数</th> <th>示例</th></tr></thead> <tbody><tr><td>sheet.defaults.rowHeight</td> <td>默认行高</td> <td>number</td> <td>sheet.defaults.rowHeight=20</td></tr> <tr><td>sheet.defaults.colWidth</td> <td>默认列宽</td> <td>number</td> <td>--</td></tr></tbody></table> <h2 id="表格-获取单元格方法"><a href="#表格-获取单元格方法" class="header-anchor">#</a> 表格 获取单元格方法</h2> <table><thead><tr><th>属性</th> <th>作用</th> <th>参数</th> <th>示例</th></tr></thead> <tbody><tr><td>getCell</td> <td>获取列</td> <td>可以一个获取列,传行列,获取指定单元格</td> <td>sheet.getCell(1)</td></tr> <tr><td>getRange</td> <td>获取区域</td> <td>开始行,开始列,结束行,结束列</td> <td>sheet.getRange(1,0,2,2)</td></tr></tbody></table> <hr> <h2 id="表格-方法"><a href="#表格-方法" class="header-anchor">#</a> 表格 方法</h2> <table><thead><tr><th>属性</th> <th>作用</th> <th>参数</th> <th>示例</th></tr></thead> <tbody><tr><td>setRowCount</td> <td>表格行数</td> <td>number</td> <td>sheet.setRowCount(1)</td></tr> <tr><td>setColumnCount</td> <td>表格列数</td> <td>number</td> <td>sheet.setColumnCount(1)</td></tr> <tr><td>setColumnWidth</td> <td>列宽</td> <td>列:number,宽度:number</td> <td>sheet.setColumnWidth(0, 80);</td></tr> <tr><td>setRowHeight</td> <td>行高</td> <td>行:number,高度:number</td> <td>sheet.setRowHeight(0, 80);</td></tr> <tr><td>setFormula</td> <td>设置公式</td> <td>行:number,列:number,公式:string(excel公式写法)</td> <td>sheet.setFormula(0, 0,'SUM(A1:A20)')</td></tr> <tr><td>setText</td> <td>设置文字内容</td> <td>行:number,列:number,内容:string</td> <td>sheet.setText(0, 0, '123')</td></tr> <tr><td>setValue</td> <td>设置数字内容</td> <td>行:number,列:number,内容:number</td> <td>sheet.setValue(0, 0, 123)</td></tr> <tr><td>addSpan</td> <td>合并单元格</td> <td>开始行,开始列,结束行,结束列</td> <td>sheet.addSpan(0, 0, 1, 1)</td></tr> <tr><td>frozenRowCount</td> <td>冻结行</td> <td>number</td> <td>sheet.frozenRowCount(4)</td></tr> <tr><td>frozenColumnCount</td> <td>冻结列</td> <td>number</td> <td>sheet.frozenColumnCount(2)</td></tr> <tr><td>zoom</td> <td>整体缩放</td> <td>number</td> <td>sheet.zoom(0.80)</td></tr> <tr><td>autoFitRow</td> <td>自动行高</td> <td>行number</td> <td>sheet.autoFitRow(1)</td></tr> <tr><td>autoFitColumn</td> <td>自动列宽</td> <td>列number</td> <td>sheet.autoFitColumn(1)</td></tr></tbody></table> <hr> <h3 id="公式"><a href="#公式" class="header-anchor">#</a> 公式</h3> <ul><li>合计公式 <code>SUM(A1:A3)</code></li> <li>除法公式 <code>SUM(A1/B1)</code></li></ul> <h3 id="设置单元格边框"><a href="#设置单元格边框" class="header-anchor">#</a> 设置单元格边框</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> lineStyle <span class="token operator">=</span> <span class="token constant">GC</span><span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>LineStyle<span class="token punctuation">.</span>thin
<span class="token keyword">var</span> lineBorder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GC<span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>LineBorder</span><span class="token punctuation">(</span><span class="token string">'black'</span><span class="token punctuation">,</span> lineStyle<span class="token punctuation">)</span>
<span class="token comment">//应用样式区域</span>
sheet<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> rowCount <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> colCount<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setBorder</span><span class="token punctuation">(</span>lineBorder<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">all</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token constant">GC</span><span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>SheetArea<span class="token punctuation">.</span>viewport<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="默认字体方向"><a href="#默认字体方向" class="header-anchor">#</a> 默认字体方向</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> style <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getDefaultStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
style<span class="token punctuation">.</span>vAlign <span class="token operator">=</span> <span class="token constant">GC</span><span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>VerticalAlign<span class="token punctuation">.</span>center
style<span class="token punctuation">.</span>hAlign <span class="token operator">=</span> <span class="token constant">GC</span><span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>HorizontalAlign<span class="token punctuation">.</span>left
<span class="token comment">//应用样式</span>
sheet<span class="token punctuation">.</span><span class="token function">setDefaultStyle</span><span class="token punctuation">(</span>style<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="单元格-方法"><a href="#单元格-方法" class="header-anchor">#</a> 单元格 方法</h2> <table><thead><tr><th>属性</th> <th>作用</th> <th>参数</th> <th>示例</th></tr></thead> <tbody><tr><td>foreColor</td> <td>文字颜色</td> <td>string</td> <td>sheet.getCell(0, 0).foreColor(&quot;white&quot;);</td></tr> <tr><td>backColor</td> <td>背景颜色</td> <td>string</td> <td>sheet.getCell(0, 0).backColor(&quot;#44546a&quot;)</td></tr> <tr><td>vAlign</td> <td>文字左右居中方式</td> <td>function</td> <td>sheet.getCell(0, 0).vAlign(GC.Spread.Sheets.VerticalAlign.center)</td></tr> <tr><td>hAlign</td> <td>文字上下居中方式</td> <td>function</td> <td>sheet.getCell(0, 0).hAlign(GC.Spread.Sheets.HorizontalAlign.center)</td></tr> <tr><td>font</td> <td>字体</td> <td>string</td> <td>sheet.getCell(0, 0).font('bold 30px simkai')</td></tr> <tr><td>wordWrap</td> <td>自动换行</td> <td>boolean</td> <td>sheet.getCell(0, 0).wordWrap(true)</td></tr> <tr><td>formatter</td> <td>格式化</td> <td>&quot;0.00%&quot;</td> <td>sheet.getCell(0, 0).formatter(&quot;0.00%&quot;)</td></tr> <tr><td>textDecoration</td> <td>文字下划线</td> <td>function</td> <td>sheet.getCell(0, 0).textDecoration(GC.Spread.Sheets.TextDecorationType.underline);</td></tr></tbody></table> <h2 id="绑定点击事件"><a href="#绑定点击事件" class="header-anchor">#</a> 绑定点击事件</h2> <hr> <h2 id="筛选"><a href="#筛选" class="header-anchor">#</a> 筛选</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>sheet<span class="token punctuation">.</span>options<span class="token punctuation">.</span>protectionOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">allowFilter</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//开始筛选</span>
    <span class="token literal-property property">allowResizeRows</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 是否允许调整行</span>
    <span class="token literal-property property">allowResizeColumns</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是否允许调整列</span>
    <span class="token literal-property property">allowSort</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//开启排序</span>
<span class="token punctuation">}</span>
<span class="token comment">//params(开始行.开始列,筛选多少行,筛选多少列) 可以筛选的区域</span>
<span class="token keyword">let</span> filter <span class="token operator">=</span> <span class="token keyword">new</span>  <span class="token class-name">GC<span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>Filter<span class="token punctuation">.</span>HideRowFilter</span><span class="token punctuation">(</span><span class="token keyword">new</span>  <span class="token class-name">GC<span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>Range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> rowCount<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//应用筛选</span>
sheet<span class="token punctuation">.</span><span class="token function">rowFilter</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr> <h2 id="导出"><a href="#导出" class="header-anchor">#</a> 导出</h2> <h3 id="导出excel"><a href="#导出excel" class="header-anchor">#</a> 导出excel</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//获取当前sheet表</span>
<span class="token keyword">var</span> sheet <span class="token operator">=</span> spread<span class="token punctuation">.</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//获取sheetname作为文件名,这里是从第一个格子获取,可以写死 或者变量传入</span>
<span class="token keyword">var</span> fileName <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>fileName<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">'.xlsx'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fileName <span class="token operator">+=</span> <span class="token string">'.xlsx'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//取消当前Excel的保护</span>
<span class="token comment">// var sheet = spread.getActiveSheet();</span>
sheet<span class="token punctuation">.</span>options<span class="token punctuation">.</span>isProtected <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">//得到导出数据</span>
<span class="token keyword">var</span> json <span class="token operator">=</span> spread<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//导出Excel</span>
<span class="token keyword">var</span> excelIo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GC<span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Excel<span class="token punctuation">.</span>IO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
excelIo<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">saveAs</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//恢复当前Excel的保护</span>
sheet<span class="token punctuation">.</span>options<span class="token punctuation">.</span>isProtected <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="导出pdf"><a href="#导出pdf" class="header-anchor">#</a> 导出pdf</h3> <ol><li>注册字体<div class="custom-block tip"><p class="title"></p><p>获取字体的二进制文件,本次使用创建了font.js储存字体二进制文件,后续引入相关js(改进时可以通过接口返回字体文件 不用进入页面都加载字体文件,实现按需引入)treeObj.registerCustomFont(fonts);</p></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> fontsObj<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;simkai.ttf&quot;</span><span class="token operator">:</span><span class="token string">'二进制'</span><span class="token punctuation">}</span><span class="token comment">//这里太长就不放二进制文件了</span>
<span class="token comment">//2.使用spreadjs 自带的注册字体方法 将字体文件传入函数     </span>
<span class="token keyword">function</span> <span class="token function">registerCustomFont</span> <span class="token punctuation">(</span><span class="token parameter">fontsObj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">var</span> fonts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">normal</span><span class="token operator">:</span> fontsObj<span class="token punctuation">[</span><span class="token string">&quot;simkai.ttf&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
 <span class="token constant">GC</span><span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span><span class="token constant">PDF</span><span class="token punctuation">.</span>PDFFontsManager<span class="token punctuation">.</span><span class="token function">registerFont</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> fonts<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token constant">GC</span><span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span><span class="token constant">PDF</span><span class="token punctuation">.</span>PDFFontsManager<span class="token punctuation">.</span><span class="token function-variable function">fallbackFont</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">font</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> fontInfoArray <span class="token operator">=</span> font<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontName <span class="token operator">=</span> fontInfoArray<span class="token punctuation">[</span>fontInfoArray<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>fontName <span class="token operator">===</span> <span class="token string">'simkai'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> fonts<span class="token punctuation">.</span>normal<span class="token punctuation">;</span><span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li>应用字体<div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//获取style属性对象</span>
 <span class="token keyword">let</span> style <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GC<span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>Style</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token comment">//修改style的fonts </span>
 style<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;16px simkai&quot;</span><span class="token punctuation">;</span>
 <span class="token comment">//通过for循环讲样式挂在在表格的每一行  </span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> spread<span class="token punctuation">.</span><span class="token function">getSheetCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   spread<span class="token punctuation">.</span>sheets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">setDefaultStyle</span><span class="token punctuation">(</span>style<span class="token punctuation">,</span><span class="token constant">GC</span><span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>SheetArea<span class="token punctuation">.</span>viewport<span class="token punctuation">)</span> 
   <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li>调整打印属性 <a href="https://www.grapecity.com.cn/blogs/spreadjs-print-info" target="_blank" rel="noopener noreferrer">打印属性官方API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1.获取当前sheet表格 注意:spread 是spread对象 需要根据实际内容进行更改</span>
sheet <span class="token operator">=</span> spread<span class="token punctuation">.</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//2.获取当前打印属性</span>
printInfo <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//3.对当前打印属性进行修改打印边距打印纸张大小打印边框(横向边框与竖向边框)居中方式(水平/垂直)打印方向(横向纸张/竖向纸张)页眉页脚黑白/彩色</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li>导出<div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1.取消当前EXCEL保护 </span>
sheet<span class="token punctuation">.</span>options<span class="token punctuation">.</span>isProtected <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token comment">//2.获取当前表格sheet名称 </span>
<span class="token keyword">var</span> fileName <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment">//3.开始打印     注意:spread 是spread对象 需要根据实际内容进行更改</span>
spread<span class="token punctuation">.</span><span class="token function">savePDF</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">saveAs</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> fileName<span class="token operator">+</span><span class="token string">'.pdf'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>                
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//4.恢复excel保护</span>
 sheet<span class="token punctuation">.</span>options<span class="token punctuation">.</span>isProtected <span class="token operator">=</span> <span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ol> <hr> <h2 id="打印-打印属性官方api"><a href="#打印-打印属性官方api" class="header-anchor">#</a> 打印 <a href="https://www.grapecity.com.cn/blogs/spreadjs-print-info" target="_blank" rel="noopener noreferrer">打印属性官方API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <div class="custom-block warning"><p class="title"></p><p>浏览器边距会覆盖打印设置边距 可能会出现显示空白页,在设置中将边距调整为无 或者调整打印页码</p></div><div class="language- extra-class"><pre><code>Q：如果打印多个sheet,但不是所有sheet。例如：spread中有四个sheet，如何打印其中的两个？
A：这样需要将spread复制到一个临时spread中，在临时spread中删除不打印的sheet，然后打印临时spread。
Q：如何将一个sheet分多页打印？
A：使用setRowPageBreak或setColumnPageBreak方法来插入行分页符或列分页符。
</code></pre></div><table><thead><tr><th>属性</th> <th>作用</th> <th>参数</th> <th>示例</th></tr></thead> <tbody><tr><td>print</td> <td>其中参数为需要打印sheet的index，传入sheet的index打印指定sheet。如果想全部打印，那么参数什么都不传即可。</td> <td>number</td> <td>spread.print(sheetIndex?);</td></tr></tbody></table> <h3 id="打印属性设置-printinfo"><a href="#打印属性设置-printinfo" class="header-anchor">#</a> 打印属性设置 printInfo</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">var</span> printInfo <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//获取printInfo</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><table><thead><tr><th>属性</th> <th>作用</th> <th>参数</th> <th>示例</th></tr></thead> <tbody><tr><td>bestFitColumns</td> <td>打印时是否每一列都自适应宽度。</td> <td>true/false</td> <td>printInfo.bestFitColumns(true/false)</td></tr> <tr><td>bestFitRows</td> <td>打印时是否每一行都自适应高度。</td> <td>true/false</td> <td>printInfo.bestFitRows(true/false)</td></tr> <tr><td>blackAndWhite</td> <td>彩色打印还是黑白打印（true为黑白打印，false为彩色打印）</td> <td>true/false</td> <td>printInfo.blackAndWhite(true/false)</td></tr> <tr><td>centering</td> <td>打印的居中方式，参数为GC.Spread.Sheets.Print.PrintCentering的枚举，有以下四种</td> <td>[both,horizontal,vertical,none]</td> <td>printInfo.centering(GC.Spread.Sheets.Print.PrintCentering.both)</td></tr> <tr><td>headerLeft</td> <td>表脚区域中间部分的文本及样式。</td> <td>text/format</td> <td>printInfo.headerLeft(text/format)</td></tr> <tr><td>headerCenter</td> <td>表脚区域左部分的文本及样式。</td> <td>text/format</td> <td>printInfo.headerCenter(text/format)</td></tr> <tr><td>headerRight</td> <td>表脚区域右部分的文本及样式。</td> <td>text/format</td> <td>printInfo.headerRight(text/format)</td></tr> <tr><td>footerCenter</td> <td>表脚区域中间部分的文本及样式。</td> <td>text/format</td> <td>printInfo.footerCenter(text/format)</td></tr> <tr><td>footerLeft</td> <td>表脚区域左部分的文本及样式。</td> <td>text/format</td> <td>printInfo.footerLeft(text/format)</td></tr> <tr><td>footerRight</td> <td>表脚区域右部分的文本及样式。</td> <td>text/format</td> <td>printInfo.footerRight(text/format)</td></tr> <tr><td>margin</td> <td>边距。</td> <td>object</td> <td>printInfo.margin({top:75, bottom:75, left:20, right:20, header:10, footer:20});</td></tr> <tr><td>orientation</td> <td>设置打印方式横向(landscape)或纵向(portrait)</td> <td>GC.Spread.Sheets.Print.PrintPageOrientation.landscape[landscape,portrait]</td> <td>printInfo.orientation(GC.Spread.Sheets.Print.PrintPageOrientation.landscape)</td></tr> <tr><td>pageOrder</td> <td>打印顺序，</td> <td>GC.Spread.Sheets.Print.PrintPageOrder的枚举。[auto,overThenDown,downThenOver]</td> <td>printInfo.pageOrder(  GC.Spread.Sheets.Print.PrintPageOrder.auto )</td></tr> <tr><td>paperSize</td> <td>设置打印纸张大小。</td> <td>new GC.Spread.Sheets.Print.PaperSize()对象</td> <td>printInfo.paperSize(new GC.Spread.Sheets.Print.PaperSize(300, 500))</td></tr> <tr><td>qualityFactor</td> <td>打印质量，value为1~8的一个数值，越高则打印效果越好。</td> <td>value</td> <td>printInfo.qualityFactor(1)</td></tr> <tr><td>repeatColumnStart</td> <td>重复打印列的起始。</td> <td>columnindex</td> <td>printInfo.repeatColumnStart(1)</td></tr> <tr><td>repeatColumnEnd</td> <td>重复打印列的结束。</td> <td>columnindex</td> <td>printInfo.repeatColumnEnd(2)</td></tr> <tr><td>repeatRowStart</td> <td>重复打印行的起始。</td> <td>rowindex</td> <td>printInfo.repeatRowStart(rowindex)</td></tr> <tr><td>repeatRowEnd</td> <td>重复打印行的结束。</td> <td>rowindex</td> <td>printInfo.repeatRowEnd(rowindex)</td></tr> <tr><td>rowEnd</td> <td>打印截至至某一行</td> <td></td> <td></td></tr> <tr><td>rowStart</td> <td>打印起始与某一行</td> <td></td> <td></td></tr> <tr><td>columnEnd</td> <td>打印截至至某一列</td> <td></td> <td></td></tr> <tr><td>columnStart</td> <td>打印起始于某一列，设置部分打印时使用。</td> <td></td> <td></td></tr> <tr><td>showBorder</td> <td>是否显示边框</td> <td>true/false</td> <td></td></tr> <tr><td>showColumnHeader</td> <td>是否打印列头</td> <td>PrintVisibilityType的枚举[inherit: 继承自表单的设置 ((默认) 行头/列头可见)。hide: 不打印。show:每页中都显示。showOnce: 显示一次 (在第一页)。]</td> <td></td></tr> <tr><td>showRowHeader</td> <td>是否打印行头</td> <td>同上</td> <td></td></tr> <tr><td>showGridLine</td> <td>是否打印网格线 (默认是打印)</td> <td>true/false</td> <td></td></tr> <tr><td>useMax</td> <td></td> <td></td> <td></td></tr> <tr><td>zoomFactor</td> <td>放大/缩小比例，例如printInfo.zoomFactor(0.8)为缩放至80%</td> <td></td> <td></td></tr></tbody></table> <div class="language- extra-class"><pre><code>text：文本内容，如：printInfo.footerCenter(&quot;GrapeCity&quot;)
format：&amp; 被用作为特殊的转义字符，用来转义以下打印特殊数据的关键字。
P: 当前页数。
N: 总页数。
D: 当前日期。（今天）
T: 当前时间。
G: 图片，用来显示相应区域图片（XXXImage）的占位符。
S: 删除线。
U: 下划线。
B: 粗体。
I: 斜体。
&quot;: (双引号)，用来设置字体。
F: Spread的名字。
A: 表单名字。
如：printInfo.footerCenter(&quot;&amp;P/&amp;N&quot;);
   printInfo.headerLeftImage(img)：表头区域左部分的图片。img为图片的路径或者图片的base64编码。
   printInfo.headerCenterImage(img)：表头区域中间部分的图片。img为图片的路径或者图片的base64编码。
   printInfo.headerRightImage(img)：表头区域右部分的图片。img为图片的路径或者图片的base64编码。
   printInfo.footerLeftImage(img)：表脚区域左部分的图片。img为图片的路径或者图片的base64编码。
   printInfo.footerCenterImage(img)：表脚区域中间部分的图片。img为图片的路径或者图片的base64编码。
   printInfo.footerRight(img)：表脚区域右部分的图片。img为图片的路径或者图片的base64编码。
   
   printInfo.margin(object)：边距。例如printInfo.margin({top:75, bottom:75, left:20, right:20, header:10, footer:20});
           value.top {number} 顶部边距
           value.bottom {number} 底部边距
           value.left {number} 左边距
           value.right {number} 右边距
           value.header {number} 顶部标题的偏移量
           value.footer {number}   底部标题的偏移量
    printInfo.orientation(GC.Spread.Sheets.Print.PrintPageOrientation.landscape/GC.Spread.Sheets.Print. PrintPageOrientation.portrait)：设置打印方式横向或纵向
     GC.Spread.Sheets.Print.PrintPageOrientation.landscape为横向
     GC.Spread.Sheets.Print.PrintPageOrientation.portrait为纵向
     如果要实现横向打印与纵向打印不仅要在设置中进行设置，还需将浏览器的设置也与之设置一致

    printInfo.pageOrder(value)：打印顺序，value为GC.Spread.Sheets.Print.PrintPageOrder的枚举。
           GC.Spread.Sheets.Print.PrintPageOrder.auto 自动
           GC.Spread.Sheets.Print.PrintPageOrder.overThenDown 先横向排列再竖向排列
           GC.Spread.Sheets.Print.PrintPageOrder.downThenOver 先横向排列再竖向排列
           当需要一页纸打印多个sheet时，可以设置打印顺序来调整sheet以横向排列还是纵向排列。

     printInfo.paperSize(paperSize)：设置打印纸张大小。
         paperSize需要初始化一个new GC.Spread.Sheets.Print.PaperSize()对象，
         其中参数有GC.Spread.Sheets.Print.PaperKind的枚举
         PaperSize对象同样支持传入纸张的宽与高来确定纸张大小，
         例如：new GC.Spread.Sheets.Print.PaperSize(300, 500)     
</code></pre></div><p>paperkind可以<a href="http://sphelp.grapecity.com/webhelp/SpreadSheets10/webframe.html#JavascriptLibrary~GC.Spread.Sheets.Print.PaperKind.html" target="_blank" rel="noopener noreferrer">参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：</p> <div class="language- extra-class"><pre><code>   printInfo.qualityFactor(value)：打印质量，value为1~8的一个数值，越高则打印效果越好。
   printInfo.repeatColumnStart(columnindex)：重复打印列的起始。
   printInfo.repeatColumnEnd(columnindex)：重复打印列的结束。
   printInfo.repeatRowStart(rowindex)：重复打印行的起始。
   printInfo.repeatRowEnd(rowindex)：重复打印行的结束。
   重复打印行列当有需要在打印的每一页都打印行列数据时使用，参数为行与列的index。

   printInfo.rowEnd(rowindex)：打印截至至某一行
   printInfo.rowStart(rowindex)：打印起始与某一行
   printInfo.columnEnd(columnindex)：打印截至至某一列
   printInfo.columnStart(columnindex)：打印起始于某一列，设置部分打印时使用。
   printInfo.showBorder(true/false)：是否显示边框
   printInfo.showColumnHeader/printInfo.showRowHeader：是否打印列头/行头，
             参数为PrintVisibilityType枚举值。
              inherit: 继承自表单的设置 ((默认) 行头/列头可见)。
              hide: 不打印。
              show: 在每页中都显示。
              showOnce: 显示一次 (在第一页)。
    printInfo.showGridLine：是否打印网格线 (默认是打印)。
    printInfo.useMax
    printInfo.zoomFactor：放大/缩小比例，例如printInfo.zoomFactor(0.8)为缩放至80%
</code></pre></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//获取当前sheet表</span>
<span class="token keyword">var</span> sheet <span class="token operator">=</span> spread<span class="token punctuation">.</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//获取打印属性对象</span>
<span class="token keyword">var</span> printInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GC<span class="token punctuation">.</span>Spread<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>Print<span class="token punctuation">.</span>PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//调整打印设置黑白</span>
<span class="token comment">//打印注意:与导出pdf打印设置一致</span>
<span class="token comment">//应用打印属性</span>
sheet<span class="token punctuation">.</span><span class="token function">printInfo</span><span class="token punctuation">(</span>printInfo<span class="token punctuation">)</span>
<span class="token comment">//打印</span>
spread<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间: </span> <span class="time">2023/1/12 15:59:09</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-ac050c62><li class="level-2" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#初始化" class="sidebar-link reco-side-初始化" data-v-ac050c62>初始化</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#配置部分" class="sidebar-link reco-side-配置部分" data-v-ac050c62>配置部分</a></li><li class="level-3" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#spread部分" class="sidebar-link reco-side-spread部分" data-v-ac050c62>spread部分</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#获取sheet对象" class="sidebar-link reco-side-获取sheet对象" data-v-ac050c62>获取sheet对象</a></li><li class="level-3" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#sheet-options参数" class="sidebar-link reco-side-sheet-options参数" data-v-ac050c62>sheet.options参数</a></li><li class="level-3" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#options-gridline" class="sidebar-link reco-side-options-gridline" data-v-ac050c62>options.gridline</a></li><li class="level-3" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#sheet-defaults参数" class="sidebar-link reco-side-sheet-defaults参数" data-v-ac050c62>sheet.defaults参数</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#表格-获取单元格方法" class="sidebar-link reco-side-表格-获取单元格方法" data-v-ac050c62>表格 获取单元格方法</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#表格-方法" class="sidebar-link reco-side-表格-方法" data-v-ac050c62>表格 方法</a></li><li class="level-3" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#公式" class="sidebar-link reco-side-公式" data-v-ac050c62>公式</a></li><li class="level-3" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#设置单元格边框" class="sidebar-link reco-side-设置单元格边框" data-v-ac050c62>设置单元格边框</a></li><li class="level-3" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#默认字体方向" class="sidebar-link reco-side-默认字体方向" data-v-ac050c62>默认字体方向</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#单元格-方法" class="sidebar-link reco-side-单元格-方法" data-v-ac050c62>单元格 方法</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#绑定点击事件" class="sidebar-link reco-side-绑定点击事件" data-v-ac050c62>绑定点击事件</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#筛选" class="sidebar-link reco-side-筛选" data-v-ac050c62>筛选</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#导出" class="sidebar-link reco-side-导出" data-v-ac050c62>导出</a></li><li class="level-3" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#导出excel" class="sidebar-link reco-side-导出excel" data-v-ac050c62>导出excel</a></li><li class="level-3" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#导出pdf" class="sidebar-link reco-side-导出pdf" data-v-ac050c62>导出pdf</a></li><li class="level-2" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#打印-打印属性官方api" class="sidebar-link reco-side-打印-打印属性官方api" data-v-ac050c62>打印 打印属性官方API</a></li><li class="level-3" data-v-ac050c62><a href="/blogs/jquery/spread/spread_API.html#打印属性设置-printinfo" class="sidebar-link reco-side-打印属性设置-printinfo" data-v-ac050c62>打印属性设置 printInfo</a></li></ul></main></div> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.79fcf93e.js" defer></script><script src="/assets/js/3.9446284f.js" defer></script><script src="/assets/js/1.83d3f97c.js" defer></script><script src="/assets/js/37.8ab9d0a9.js" defer></script>
  </body>
</html>
